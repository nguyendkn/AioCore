@page "/setting/builder"
@layout EmptyLayout

<div>
<div class="hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0 bg-white border-r">
  <div class="flex flex-col flex-grow pt-5 bg-white overflow-y-auto">
    <div class="flex font-bold">
      <Button Type="@ButtonType.Link" class="flex items-center flex-shrink-0 px-4">
        <i class="fa-duotone fa-caret-left"></i>
      </Button>
      <h1 class="flex my-auto">Giao diện</h1>
    </div>
    <div class="mt-5 flex-1 flex flex-col">
      <h1 class="font-bold px-2.5">Mã nguồn</h1>
      <Tree @ref="tree" DefaultExpandAll Draggable BlockNode
            ShowIcon DataSource="games" Class="border m-2.5 shadow-sm rounded-md"
            TitleExpression="x => x.DataItem.Text"
            ChildrenExpression="x => x.DataItem.Items"
            IconExpression="x => x.DataItem.Icon"
            IsLeafExpression="x => x.DataItem.Items?.Count == 0"
            KeyExpression="x => x.DataItem.Id"
            TItem="GameElement" OnDragEnd="e => { }" OnDrop="onDrop">
      </Tree>
      <div class="space-grow grow"></div>
      <div class="">
        <div class="px-2 pb-3 space-y-1">
          <NavLink href="#" class="bg-[#001529] text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
            <i class="fa-duotone fa-swatchbook mr-2"></i>
            Màu sắc
          </NavLink>
        </div>
        <div class="px-2 pb-3 space-y-1">
          <NavLink href="#" class="bg-[#001529] text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
            <i class="fa-duotone fa-swatchbook mr-2"></i>
            Thiết lập tổng quan
          </NavLink>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="md:pl-64 flex flex-col flex-1">
  <div class="sticky top-0 z-10 flex-shrink-0 flex h-16 bg-white border-b">
  </div>
  <main>
    <div class="py-6">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8">
        <h1 class="text-2xl font-semibold text-gray-900">Dashboard</h1>
      </div>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8">
        <div class="py-4">
          <div class="border-4 border-dashed border-gray-200 rounded-lg h-96"></div>
        </div>
      </div>
    </div>
  </main>
</div>
</div>

@code{

  Tree<GameElement> tree;

  string selectedKey;

  GameElement selectedData;

  TreeNode<GameElement> selectedNode;

  List<GameElement> games = new()
  {
    new ("0-0","0-0")
    {
      Items = new List<GameElement>()
      {
        new ("0-0-0","0-0-0")
        {
          Items = new List<GameElement>()
          {
            new ("0-0-0-0","0-0-0-0"),
            new ("0-0-0-1","0-0-0-1"),
            new ("0-0-0-2","0-0-0-2"),
          }
        },
        new ("0-0-1","0-0-1")
        {
          Items = new List<GameElement>()
          {
            new ("0-0-1-0","0-0-1-0"),
            new ("0-0-1-1","0-0-1-1"),
            new ("0-0-1-2","0-0-1-2"),
          }
        },
        new ("0-0-2","0-0-2")
        {
          Items = new List<GameElement>()
          {
            new ("0-0-2-0","0-0-2-0"),
            new ("0-0-2-1","0-0-2-1"),
            new ("0-0-2-2","0-0-2-2"),
          }
        },
      }
    },
    new ("0-1","0-1")
    {
      Items = new List<GameElement>()
      {
        new ("0-1-0","0-1-0"),
        new ("0-1-1","0-1-0"),
        new ("0-1-2","0-1-2"),
      }
    },
    new ("0-2","0-2")
    {
      Items = new List<GameElement>()
      {
        new ("0-2-0","0-2-0"),
        new ("0-2-1","0-2-1"),
      }
    }
  };

  private record GameElement(string Id, string Text, string Icon = null)
  {
    public List<GameElement> Items { get; set; } = new List<GameElement>();
  }

  void onDrop(TreeEventArgs<GameElement> e)
  {

  }
}